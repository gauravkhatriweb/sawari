# 🚗 Sawari.pk - Next Gen Uber

<div align="center">

![Node.js](https://img.shields.io/badge/Node.js-339933?style=for-the-badge&logo=nodedotjs&logoColor=white)
![Express.js](https://img.shields.io/badge/Express.js-000000?style=for-the-badge&logo=express&logoColor=white)
![MongoDB](https://img.shields.io/badge/MongoDB-4EA94B?style=for-the-badge&logo=mongodb&logoColor=white)
![JWT](https://img.shields.io/badge/JWT-000000?style=for-the-badge&logo=JSON%20web%20tokens&logoColor=white)

**A comprehensive passenger management system built with modern web technologies** 🚀

*Empowering seamless passenger experiences with robust authentication and profile management*

[![GitHub stars](https://img.shields.io/github/stars/gauravkhatriweb/sawaridotpk?style=social)](https://github.com/gauravkhatriweb/sawaridotpk)
[![GitHub forks](https://img.shields.io/github/forks/gauravkhatriweb/sawaridotpk?style=social)](https://github.com/gauravkhatriweb/sawaridotpk)
[![GitHub issues](https://img.shields.io/github/issues/gauravkhatriweb/sawaridotpk)](https://github.com/gauravkhatriweb/sawaridotpk/issues)
[![GitHub license](https://img.shields.io/github/license/gauravkhatriweb/sawaridotpk)](https://github.com/gauravkhatriweb/sawaridotpk/blob/main/LICENSE)

</div>

---

## 🎯 What's Special About Sawari.pk?

✨ **Modern Authentication** - JWT-based secure authentication  
🔒 **Password Security** - bcrypt hashing with salt rounds  
🍪 **Smart Cookies** - HTTP-only cookies for XSS protection  
📱 **Real-time Ready** - Socket ID support for live features  
⚡ **Lightning Fast** - Optimized Express.js backend  
🛡️ **Production Ready** - Comprehensive error handling & validation  

---

## 👨‍💻 Meet the Developer

<div align="center">

**Developed with ❤️ by**

### [Gaurav Khatri](https://gauravkhatriweb.bio)

[![Website](https://img.shields.io/badge/Website-gauravkhatriweb.bio-blue?style=for-the-badge)](https://gauravkhatriweb.bio)
[![Email](https://img.shields.io/badge/Email-gauravkhatriweb%40gmail.com-red?style=for-the-badge)](mailto:gauravkhatriweb@gmail.com)
[![GitHub](https://img.shields.io/badge/GitHub-%40gauravkhatriweb-black?style=for-the-badge&logo=github)](https://github.com/gauravkhatriweb)

*Full-stack developer passionate about creating amazing user experiences* 🚀

</div>

---

## 📋 Table of Contents

<div align="center">

| [🛠️ Tech Stack](#️-tech-stack) | [📦 Dependencies](#-backend-dependencies) | [🚀 Getting Started](#-getting-started) |
|---|---|---|
| [📚 API Reference](#-backend-api-reference) | [🗄️ Database](#️-database-schema) | [🔧 Project Structure](#-project-structure) |
| [🛡️ Security](#️-security-features) | [🚀 Deployment](#-deployment) | [🤝 Contributing](#-contributing) |
| [📄 License](#-license) | [📞 Support](#-support) | |

</div>

---

## 🛠️ Tech Stack

<div align="center">

| **Backend** | **Database** | **Authentication** | **Security** |
|-------------|--------------|-------------------|--------------|
| ![Node.js](https://img.shields.io/badge/Node.js-✓-green) | ![MongoDB](https://img.shields.io/badge/MongoDB-✓-green) | ![JWT](https://img.shields.io/badge/JWT-✓-green) | ![bcrypt](https://img.shields.io/badge/bcrypt-✓-green) |
| ![Express.js](https://img.shields.io/badge/Express.js-✓-green) | ![Mongoose](https://img.shields.io/badge/Mongoose-✓-green) | ![Cookies](https://img.shields.io/badge/Cookies-✓-green) | ![CORS](https://img.shields.io/badge/CORS-✓-green) |

</div>

---

## 🎨 Frontend (Web Application)

<div align="center">

![Vite](https://img.shields.io/badge/Vite-646CFF?style=for-the-badge&logo=vite&logoColor=white)
![React](https://img.shields.io/badge/React-61DAFB?style=for-the-badge&logo=react&logoColor=061A23)
![React Router](https://img.shields.io/badge/React%20Router-CA4245?style=for-the-badge&logo=reactrouter&logoColor=white)
![Tailwind CSS](https://img.shields.io/badge/TailwindCSS-38BDF8?style=for-the-badge&logo=tailwindcss&logoColor=white)
![Framer Motion](https://img.shields.io/badge/Framer%20Motion-0055FF?style=for-the-badge&logo=framer&logoColor=white)
![Axios](https://img.shields.io/badge/Axios-5A29E4?style=for-the-badge&logo=axios&logoColor=white)

</div>

### 📦 Frontend Dependencies

<div align="center">

| Package | Version | Status | Description |
|---------|---------|--------|-------------|
| `react` | `^19.1.1` | ![Latest](https://img.shields.io/badge/Latest-green) | ⚛️ React library |
| `react-dom` | `^19.1.1` | ![Latest](https://img.shields.io/badge/Latest-green) | ⚛️ React DOM renderer |
| `react-router-dom` | `^7.8.2` | ![Latest](https://img.shields.io/badge/Latest-green) | 🛣️ Client-side routing |
| `vite` | `^7.1.2` | ![Latest](https://img.shields.io/badge/Latest-green) | ⚡ Build tool & dev server |
| `tailwindcss` | `^4.1.12` | ![Latest](https://img.shields.io/badge/Latest-green) | 🎨 Utility-first CSS framework |
| `framer-motion` | `^12.23.12` | ![Latest](https://img.shields.io/badge/Latest-green) | 🎬 Animation library |
| `axios` | `^1.11.0` | ![Latest](https://img.shields.io/badge/Latest-green) | 🌐 HTTP client |
| `react-toastify` | `^11.0.5` | ![Latest](https://img.shields.io/badge/Latest-green) | 🔔 Toast notifications |

</div>

### 🛠️ Tech Stack & Features

- **⚛️ React 19.1.1** - Latest React with modern hooks and features
- **⚡ Vite 7.1.2** - Lightning-fast build tool and dev server
- **🛣️ React Router DOM 7.8.2** - Declarative client-side routing
- **🎨 Tailwind CSS 4.1.12** - Utility-first CSS with dark theme support
- **🎬 Framer Motion 12.23.12** - Production-ready motion library
- **🌐 Axios 1.11.0** - Promise-based HTTP client for API calls
- **🔔 React Toastify 11.0.5** - Beautiful toast notifications
- **📱 Responsive Design** - Mobile-first approach with glassmorphism effects
- **🎯 Brand Guidelines** - Consistent design system following `brandguidelines.md`

### 🚀 Quick Start

```bash
# Navigate to frontend directory
cd frontend

# Install dependencies
npm install

# Start development server
npm run dev

# Build for production
npm run build

# Preview production build
npm run preview
```

**🌐 Development server:** `http://localhost:5173`

### 🧰 Available Scripts

<div align="center">

| Script | Command | Description | Status |
|--------|---------|-------------|--------|
| **Development** | `npm run dev` | Start Vite dev server with HMR | ✅ Ready |
| **Build** | `npm run build` | Production build with optimization | ✅ Ready |
| **Preview** | `npm run preview` | Preview production build locally | ✅ Ready |
| **Lint** | `npm run lint` | Run ESLint for code quality | ✅ Ready |

</div>

### 🧱 Stack & Libraries

- React (Vite) SPA with React Router
- Tailwind CSS utility-first styling, dark theme-first design
- Brand-driven components inspired by `frontend/src/assets/brandguidelines.md`

### 📦 Frontend Setup

```bash
cd frontend
npm install
npm run dev
```

Default dev server: `http://localhost:5173`

### 🧰 NPM Scripts (frontend/package.json)

| Script | Description |
|--------|-------------|
| `dev` | Start Vite dev server |
| `build` | Production build |
| `preview` | Preview production build |
| `lint` | Lint frontend code |

### 🗺️ Routes (React Router)

| Path | Page Component | Purpose |
|------|-----------------|---------|
| `/` | `pages/Home.jsx` | Onboarding landing screen with CTA |
| `/passenger/login` | `pages/passengerPages/PassengerLogin.jsx` | Passenger sign-in |
| `/passenger/register` | `pages/passengerPages/PassengerRegister.jsx` | Passenger sign-up |
| `/captain/login` | `pages/captainPages/CaptainLogin.jsx` | Captain sign-in |
| `/captain/register` | `pages/captainPages/CaptainRegister.jsx` | Captain sign-up (2-step) |
| `/legal/terms` | `pages/legalPages/TermsPage.jsx` | Terms & Conditions |
| `/legal/privacy` | `pages/legalPages/PrivacyPage.jsx` | Privacy Policy |

### 📄 Key Pages

- `Home.jsx`: Branded onboarding, gradient accents, bold black CTA (“Get Started”).
- `PassengerLogin.jsx`: Email + password with show/hide, remember me, captain switch, validation.
- `PassengerRegister.jsx`: First name, last name (optional), email, password with validation.
- `CaptainLogin.jsx`: Mirrored UX of passenger login; captain-focused copy.
- `CaptainRegister.jsx`: Two-step form (Personal → Vehicle). Vehicle fields: type, make, model, year, color, number plate (format `AA-1234`), capacity. Per-step validation, Back/Next flow.
- `TermsPage.jsx` & `PrivacyPage.jsx`: Legal pages with branded layout and Back to Home button.

### 🎨 Design System & Branding

#### 🌈 **Color Palette**
<div align="center">

| Color | Hex Code | Usage | Preview |
|-------|----------|-------|----------|
| **Primary Blue** | `#4DA6FF` | CTAs, links, highlights | ![#4DA6FF](https://via.placeholder.com/20/4DA6FF/000000?text=+) |
| **Gradient Pink** | `#EFBFFF` | Sawari Pink, gradients | ![#EFBFFF](https://via.placeholder.com/20/EFBFFF/000000?text=+) |
| **Bright Yellow** | `#FFD65C` | Accents, highlights | ![#FFD65C](https://via.placeholder.com/20/FFD65C/000000?text=+) |
| **Aqua Green** | `#7CE7E1` | Success states, features | ![#7CE7E1](https://via.placeholder.com/20/7CE7E1/000000?text=+) |
| **Neutral Dark** | `#1A1A1A` | Backgrounds, text | ![#1A1A1A](https://via.placeholder.com/20/1A1A1A/000000?text=+) |

</div>

#### 🔤 **Typography**
- **Primary Font**: Inter (UI elements, body text, forms)
- **Display Font**: Poppins (headings, marketing copy, CTAs)
- **Font Weights**: 300, 400, 500, 600, 700
- **Responsive Scaling**: Mobile-first approach

#### ✨ **Visual Effects**
- **Glassmorphism**: Backdrop blur effects with transparency
- **Gradient Orbs**: Ambient background lighting effects
- **Smooth Animations**: Framer Motion powered interactions
- **Dark Theme**: Primary dark color scheme
- **High Contrast**: Accessibility-focused design

### 🧩 Reusable Components

<div align="center">

| Component | Purpose | Features | Status |
|-----------|---------|----------|--------|
| `Navbar.jsx` | 🧭 Main navigation | Responsive, brand logo, route highlighting | ✅ Ready |
| `CaptainNavbar.jsx` | 🚗 Captain navigation | Captain-specific navigation | ✅ Ready |
| `Footer.jsx` | 🦶 Site footer | Links, branding, responsive | ✅ Ready |
| `Hero.jsx` | 🎯 Hero sections | Gradient backgrounds, CTAs | ✅ Ready |
| `Features.jsx` | ⭐ Feature showcase | Grid layout, icons, descriptions | ✅ Ready |

</div>

### 📱 Responsive Design Features

- **Mobile-First Approach**: Designed for mobile, enhanced for desktop
- **Breakpoint System**: sm, md, lg, xl responsive breakpoints
- **Touch-Friendly**: Optimized for touch interactions
- **Progressive Enhancement**: Works without JavaScript
- **Performance Optimized**: Lazy loading and code splitting

### 📁 Detailed Frontend Structure

```
frontend/
├── 📁 public/                     # Static assets
├── 📁 src/
│   ├── 📁 assets/                  # Brand assets
│   │   ├── 📄 brandguidelines.md   # Design system guidelines
│   │   └── 📁 branding/            # Logo, images
│   ├── 📁 components/              # Reusable components
│   │   ├── 🧭 Navbar.jsx           # Main navigation
│   │   ├── 🚗 CaptainNavbar.jsx    # Captain navigation
│   │   ├── 🦶 Footer.jsx           # Site footer
│   │   ├── 🎯 Hero.jsx             # Hero sections
│   │   └── ⭐ Features.jsx         # Feature showcase
│   ├── 📁 context/                 # React Context providers
│   ├── 📁 pages/                   # Page components
│   │   ├── 🏠 Home.jsx             # Landing page
│   │   ├── ℹ️ AboutPage.jsx        # About Sawari.pk
│   │   ├── 🎯 Onboarding.jsx       # User onboarding
│   │   ├── 📁 passengerPages/      # Passenger-specific pages
│   │   │   ├── 🔐 PassengerLogin.jsx
│   │   │   ├── ✍️ PassengerRegister.jsx
│   │   │   ├── 🔐 PassengerForgotPassword.jsx
│   │   │   ├── 🔑 PassengerResetPassword.jsx
│   │   │   ├── ✅ PassengerVerifyOtp.jsx
│   │   │   ├── 👤 PassengerProfile.jsx      # 🖼️ Profile picture management
│   │   │   └── 🏠 PassengerHome.jsx
│   │   ├── 📁 captainPages/        # Captain-specific pages
│   │   │   ├── 🔐 CaptainLogin.jsx
│   │   │   ├── ✍️ CaptainRegister.jsx
│   │   │   ├── 🔐 CaptainForgotPassword.jsx
│   │   │   ├── 🔑 CaptainResetPassword.jsx
│   │   │   ├── ✅ CaptainVerifyOtp.jsx
│   │   │   ├── 👤 CaptainProfile.jsx       # 🖼️ Profile picture management
│   │   │   └── 🏠 CaptainHome.jsx
│   │   ├── 📁 legalPages/          # Legal & support pages
│   │   │   ├── 📋 TermsPage.jsx
│   │   │   ├── 🔒 PrivacyPage.jsx
│   │   │   ├── 📞 ContactPage.jsx
│   │   │   └── ❓ FAQPage.jsx
│   │   └── 📁 errorPages/          # Error handling
│   │       └── ❌ NotFound.jsx
│   ├── ⚛️ App.jsx                  # Main app component
│   ├── 🎯 main.jsx                 # App entry point
│   ├── 🎨 App.css                  # Global styles
│   └── 🎨 index.css                # Base styles
├── 📄 index.html                   # HTML template
├── 📦 package.json                 # Dependencies & scripts
├── ⚙️ vite.config.js              # Vite configuration
├── 🔧 eslint.config.js            # ESLint configuration
└── 🔒 .env                        # Environment variables
```

---

## 📦 Backend Dependencies

<div align="center">

| Package | Version | Status | Description |
|---------|---------|--------|-------------|
| `bcrypt` | `^6.0.0` | ![Latest](https://img.shields.io/badge/Latest-green) | 🔐 Password hashing library |
| `cookie-parser` | `^1.4.7` | ![Latest](https://img.shields.io/badge/Latest-green) | 🍪 Parse Cookie header |
| `cors` | `^2.8.5` | ![Latest](https://img.shields.io/badge/Latest-green) | 🌐 Cross-Origin Resource Sharing |
| `dotenv` | `^17.2.1` | ![Latest](https://img.shields.io/badge/Latest-green) | 🔧 Environment variables |
| `express` | `^4.18.2` | ![Latest](https://img.shields.io/badge/Latest-green) | ⚡ Web framework |
| `express-validator` | `^7.2.1` | ![Latest](https://img.shields.io/badge/Latest-green) | ✅ Input validation |
| `jsonwebtoken` | `^9.0.2` | ![Latest](https://img.shields.io/badge/Latest-green) | 🔑 JWT implementation |
| `mongoose` | `^8.18.0` | ![Latest](https://img.shields.io/badge/Latest-green) | 🗄️ MongoDB ODM |
| `multer` | `^1.4.5-lts.1` | ![Latest](https://img.shields.io/badge/Latest-green) | 📤 File upload middleware |
| `nodemailer` | `^7.0.5` | ![Latest](https://img.shields.io/badge/Latest-green) | 📧 Email sending service |
| `nodemon` | `^3.1.10` | ![Latest](https://img.shields.io/badge/Latest-green) | 🔄 Auto-restart dev server |

</div>

---

## 🚀 Getting Started

### 📋 Prerequisites

<div align="center">

![Node.js](https://img.shields.io/badge/Node.js-v14+-green?style=for-the-badge&logo=node.js)
![MongoDB](https://img.shields.io/badge/MongoDB-Local%20or%20Cloud-blue?style=for-the-badge&logo=mongodb)
![npm](https://img.shields.io/badge/npm-or%20yarn-orange?style=for-the-badge&logo=npm)

</div>

### 🛠️ Installation

<div align="center">

#### **Step 1: Clone the Repository** 📥

```bash
git clone https://github.com/gauravkhatriweb/sawaridotpk.git
cd sawaridotpk
```

#### **Step 2: Install Dependencies** 📦

```bash
cd backend
npm install
```

#### **Step 3: Environment Setup** ⚙️

Create a `.env` file in the backend directory:

```env
PORT=3000
MONGODB_URI=mongodb://localhost:27017/sawari_pk
JWT_SECRET=your-super-secret-jwt-key
NODE_ENV=development
CORS_ORIGIN=http://localhost:3000
EMAIL_USER=your-email@gmail.com
EMAIL_PASS=your-app-password
```

#### **Step 4: Start the Server** 🚀

```bash
npm start
```

**🎉 Server will be running on `http://localhost:3000`**

</div>

---

## 🖼️ Profile Picture Configuration

<div align="center">

**Complete profile picture system with file upload, validation, and management** 🎆

![Profile Picture Feature](https://img.shields.io/badge/Profile%20Pictures-Ready-brightgreen?style=for-the-badge)
![File Upload](https://img.shields.io/badge/File%20Upload-Multer-blue?style=for-the-badge)
![Validation](https://img.shields.io/badge/Validation-Complete-green?style=for-the-badge)

</div>

### 📦 **File Upload System**

<div align="center">

| Feature | Details | Status |
|---------|---------|--------|
| **📁 Storage Location** | `./uploads/profile-pictures/` | ✅ Auto-created |
| **📄 File Types** | JPG, JPEG, PNG only | ✅ Validated |
| **📍 File Size** | Maximum 2MB per file | ✅ Enforced |
| **📝 Naming Convention** | `{userId}_{timestamp}.{ext}` | ✅ Unique |
| **🗑️ Auto Cleanup** | Old files deleted on update | ✅ Implemented |

</div>

### ⚙️ **Multer Middleware Configuration**

```javascript
// File upload configuration
const upload = multer({
  storage: multer.diskStorage({
    destination: './uploads/profile-pictures/',
    filename: (req, file, cb) => {
      const userId = req.passenger?._id || req.captain?._id;
      const timestamp = Date.now();
      const ext = path.extname(file.originalname);
      cb(null, `${userId}_${timestamp}${ext}`);
    }
  }),
  limits: {
    fileSize: 2 * 1024 * 1024, // 2MB limit
    files: 1 // Only one file allowed
  },
  fileFilter: (req, file, cb) => {
    const allowedTypes = /jpeg|jpg|png/;
    const extname = allowedTypes.test(path.extname(file.originalname).toLowerCase());
    const mimetype = allowedTypes.test(file.mimetype);
    
    if (mimetype && extname) {
      return cb(null, true);
    } else {
      cb(new Error('Only JPG, JPEG, and PNG files are allowed'), false);
    }
  }
});
```

### 📈 **API Endpoints Summary**

<div align="center">

| **User Type** | **Upload** | **Update** | **Delete** | **Authentication** |
|---------------|------------|------------|------------|--------------------|
| **👥 Passenger** | `POST /api/passengers/upload-profile-pic` | `PUT /api/passengers/update-profile-pic` | `DELETE /api/passengers/delete-profile-pic` | JWT Required |
| **🚗 Captain** | `POST /api/captain/upload-profile-pic` | `PUT /api/captain/update-profile-pic` | `DELETE /api/captain/delete-profile-pic` | JWT Required |

</div>

### 🔒 **Security Features**

- **🔐 Authentication Required**: Only logged-in users can manage their own profile pictures
- **📋 File Type Validation**: Server-side validation prevents malicious file uploads
- **📍 Size Limits**: 2MB maximum prevents server storage abuse
- **🗑️ Automatic Cleanup**: Old profile pictures are deleted when updated/removed
- **🗂 Error Handling**: Comprehensive error responses for all scenarios

### 🌐 **Frontend Integration**

- **🖼️ Navbar Display**: Profile pictures appear in navigation bars with gradient fallbacks
- **📝 Profile Pages**: Full upload/update/delete interface with drag-and-drop
- **📨 Real-time Sync**: Immediate updates across all components without page refresh
- **📱 Responsive Design**: Works seamlessly on desktop, tablet, and mobile
- **✨ Animations**: Smooth transitions and loading states using Framer Motion

---

## 📚 Backend API Reference

### 🔐 Authentication Endpoints

<div align="center">

| Method | URL | Description | Auth Required | Status |
|--------|-----|-------------|---------------|--------|
| `POST` | `/api/passengers/register` | Register a new passenger | ❌ No | ✅ Ready |
| `POST` | `/api/passengers/login` | Passenger login | ❌ No | ✅ Ready |
| `GET` | `/api/passengers/profile` | Get passenger profile | ✅ Yes | ✅ Ready |
| `POST` | `/api/passengers/logout` | Passenger logout | ✅ Yes | ✅ Ready |
| `POST` | `/api/passengers/send-verification-otp` | Send verification OTP | ✅ Yes | ✅ Ready |
| `POST` | `/api/passengers/verify-otp` | Verify account with OTP | ✅ Yes | ✅ Ready |
| `POST` | `/api/passengers/is-authenticated` | Check authentication status | ✅ Yes | ✅ Ready |
| `POST` | `/api/passengers/send-reset-password-otp` | Send password reset OTP | ❌ No | ✅ Ready |
| `POST` | `/api/passengers/reset-password` | Reset password with OTP | ❌ No | ✅ Ready |
| `POST` | `/api/passengers/upload-profile-pic` | Upload profile picture | ✅ Yes | ✅ Ready |
| `PUT` | `/api/passengers/update-profile-pic` | Update profile picture | ✅ Yes | ✅ Ready |
| `DELETE` | `/api/passengers/delete-profile-pic` | Delete profile picture | ✅ Yes | ✅ Ready |
| `POST` | `/api/captain/register` | Register a new captain | ❌ No | ✅ Ready |
| `POST` | `/api/captain/login` | Captain login | ❌ No | ✅ Ready |
| `GET` | `/api/captain/profile` | Get captain profile | ✅ Yes | ✅ Ready |
| `POST` | `/api/captain/logout` | Captain logout | ✅ Yes | ✅ Ready |
| `POST` | `/api/captain/send-verification-otp` | Send verification OTP | ✅ Yes | ✅ Ready |
| `POST` | `/api/captain/verify-otp` | Verify account with OTP | ✅ Yes | ✅ Ready |
| `POST` | `/api/captain/is-authenticated` | Check authentication status | ✅ Yes | ✅ Ready |
| `POST` | `/api/captain/send-reset-password-otp` | Send password reset OTP | ❌ No | ✅ Ready |
| `POST` | `/api/captain/reset-password` | Reset password with OTP | ❌ No | ✅ Ready |
| `POST` | `/api/captain/upload-profile-pic` | Upload profile picture | ✅ Yes | ✅ Ready |
| `PUT` | `/api/captain/update-profile-pic` | Update profile picture | ✅ Yes | ✅ Ready |
| `DELETE` | `/api/captain/delete-profile-pic` | Delete profile picture | ✅ Yes | ✅ Ready |

</div>

---

### 1️⃣ Register a New Passenger

<div align="center">

**`POST` `/api/passengers/register`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-No-red?style=for-the-badge)

</div>

#### 📝 Request Body

| Parameter | Type | Required | Description | Validation |
|-----------|------|----------|-------------|------------|
| `firstname` | String | ✅ Yes | Passenger's first name | Min 3 characters |
| `lastname` | String | ✅ Yes | Passenger's last name | Min 3 characters |
| `email` | String | ✅ Yes | Passenger's email address | Valid email format |
| `password` | String | ✅ Yes | Passenger's password | Min 6 characters |

#### 📤 Example Request

```json
{
  "firstname": "John",
  "lastname": "Doe",
  "email": "john.doe@example.com",
  "password": "password123"
}
```

#### ✅ Success Response

```
Code: 201 Created
```

```json
{
  "success": true,
  "message": "Passenger created successfully",
  "passenger": {
    "_id": "64f8a1b2c3d4e5f6a7b8c9d0",
    "firstname": "John",
    "lastname": "Doe",
    "email": "john.doe@example.com",
    "socketId": null,
    "createdAt": "2024-01-15T10:30:00.000Z",
    "updatedAt": "2024-01-15T10:30:00.000Z"
  },
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | Validation failed | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `409` | Email already exists (Passenger) | ![Conflict](https://img.shields.io/badge/409-Conflict-orange) |
| `409` | Email already exists (Captain) | ![Conflict](https://img.shields.io/badge/409-Conflict-orange) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** Upon successful registration, a JWT token is generated and returned in the response.

---

### 2️⃣ Passenger Login

<div align="center">

**`POST` `/api/passengers/login`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-No-red?style=for-the-badge)

</div>

#### 📝 Request Body

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `email` | String | ✅ Yes | Passenger's email address |
| `password` | String | ✅ Yes | Passenger's password |

#### 📤 Example Request

```json
{
  "email": "john.doe@example.com",
  "password": "password123"
}
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Passenger logged in successfully",
  "passenger": {
    "_id": "64f8a1b2c3d4e5f6a7b8c9d0",
    "firstname": "John",
    "lastname": "Doe",
    "email": "john.doe@example.com",
    "socketId": null,
    "createdAt": "2024-01-15T10:30:00.000Z",
    "updatedAt": "2024-01-15T10:30:00.000Z"
  },
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | Missing fields | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `401` | Invalid credentials | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `401` | Email belongs to captain | ![Unauthorized](https://img.shields.io/badge/401-Cross--Model-orange) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** Upon successful login, a JWT token is set in an HTTP-only cookie and returned in the response.

---

### 3️⃣ Get Passenger Profile

<div align="center">

**`GET` `/api/passengers/profile`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Passenger profile retrieved successfully",
  "passenger": {
    "_id": "64f8a1b2c3d4e5f6a7b8c9d0",
    "firstname": "John",
    "lastname": "Doe",
    "email": "john.doe@example.com",
    "socketId": null,
    "createdAt": "2024-01-15T10:30:00.000Z",
    "updatedAt": "2024-01-15T10:30:00.000Z"
  }
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `401` | Invalid token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint returns the authenticated passenger's profile data excluding sensitive information like password.

---

### 4️⃣ Passenger Logout

<div align="center">

**`POST` `/api/passengers/logout`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Passenger logged out successfully",
  "passenger": {
    "_id": "64f8a1b2c3d4e5f6a7b8c9d0",
    "firstname": "John",
    "lastname": "Doe",
    "email": "john.doe@example.com",
    "socketId": null,
    "createdAt": "2024-01-15T10:30:00.000Z",
    "updatedAt": "2024-01-15T10:30:00.000Z"
  }
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `404` | Passenger not found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint clears the authentication cookie and clears the passenger's socketId for real-time features.

---

### 5️⃣ Send Verification OTP

<div align="center">

**`POST` `/api/passengers/send-verification-otp`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Verification OTP sent successfully"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | Account already verified | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `404` | User not found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint sends a 6-digit OTP to the passenger's email for account verification. The OTP expires in 10 minutes.

---

### 6️⃣ Verify Account with OTP

<div align="center">

**`POST` `/api/passengers/verify-otp`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
```

#### 📝 Request Body

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `otp` | String | ✅ Yes | 6-digit verification OTP |

#### 📤 Example Request

```json
{
  "otp": "123456"
}
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Account verified successfully"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | OTP required | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Invalid OTP | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | OTP expired | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `404` | User not found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint verifies the passenger's account using the OTP sent to their email. Once verified, the account status is updated.

---

### 7️⃣ Check Authentication Status

<div align="center">

**`POST` `/api/passengers/is-authenticated`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "User is authenticated"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `401` | Invalid token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint checks if the passenger is currently authenticated with a valid JWT token.

---

### 8️⃣ Send Password Reset OTP

<div align="center">

**`POST` `/api/passengers/send-reset-password-otp`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-No-red?style=for-the-badge)

</div>

#### 📝 Request Body

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `email` | String | ✅ Yes | Passenger's email address |

#### 📤 Example Request

```json
{
  "email": "john.doe@example.com"
}
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Password reset OTP sent successfully"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | Email required | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Account not verified | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `404` | No account found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint sends a 6-digit OTP to the passenger's email for password reset. The account must be verified first.

---

### 9️⃣ Reset Password with OTP

<div align="center">

**`POST` `/api/passengers/reset-password`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-No-red?style=for-the-badge)

</div>

#### 📝 Request Body

| Parameter | Type | Required | Description | Validation |
|-----------|------|----------|-------------|------------|
| `email` | String | ✅ Yes | Passenger's email address | Valid email format |
| `otp` | String | ✅ Yes | 6-digit reset OTP | 6 characters |
| `newPassword` | String | ✅ Yes | New password | Min 6 characters |

#### 📤 Example Request

```json
{
  "email": "john.doe@example.com",
  "otp": "123456",
  "newPassword": "newpassword123"
}
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Password reset successful"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | Missing fields | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Password too short | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Invalid OTP | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | OTP expired | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Same password | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `404` | No account found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint resets the passenger's password using the OTP sent to their email. The new password must be different from the current one.

---

### 1️⃣🔟 Upload Passenger Profile Picture

<div align="center">

**`POST` `/api/passengers/upload-profile-pic`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
Content-Type: multipart/form-data
```

#### 📝 Request Body (Form Data)

| Parameter | Type | Required | Description | Validation |
|-----------|------|----------|-------------|------------|
| `profilePic` | File | ✅ Yes | Image file for profile picture | JPG/JPEG/PNG, max 2MB |

#### 📤 Example Request

```javascript
const formData = new FormData();
formData.append('profilePic', selectedFile);

fetch('/api/passengers/upload-profile-pic', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'
  },
  body: formData
});
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Profile picture uploaded successfully",
  "profilePic": "/uploads/profile-pictures/64f8a1b2c3d4e5f6a7b8c9d0_1673788800000.jpg"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | No file uploaded | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Invalid file type | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | File too large | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `404` | Passenger not found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint uploads a new profile picture for the authenticated passenger. If a profile picture already exists, it will be replaced and the old file will be deleted. Maximum file size is 2MB. Accepted formats: JPG, JPEG, PNG.

---

### 2️⃣🔟 Update Passenger Profile Picture

<div align="center">

**`PUT` `/api/passengers/update-profile-pic`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
Content-Type: multipart/form-data
```

#### 📝 Request Body (Form Data)

| Parameter | Type | Required | Description | Validation |
|-----------|------|----------|-------------|------------|
| `profilePic` | File | ✅ Yes | New image file for profile picture | JPG/JPEG/PNG, max 2MB |

#### 📤 Example Request

```javascript
const formData = new FormData();
formData.append('profilePic', selectedFile);

fetch('/api/passengers/update-profile-pic', {
  method: 'PUT',
  headers: {
    'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'
  },
  body: formData
});
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Profile picture updated successfully",
  "profilePic": "/uploads/profile-pictures/64f8a1b2c3d4e5f6a7b8c9d0_1673788900000.jpg"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | No file uploaded | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Invalid file type | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | File too large | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `404` | Passenger not found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint updates an existing profile picture for the authenticated passenger. The old profile picture file will be automatically deleted from the server. If no profile picture exists, this works the same as upload.

---

### 2️⃣1️⃣ Delete Passenger Profile Picture

<div align="center">

**`DELETE` `/api/passengers/delete-profile-pic`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Profile picture deleted successfully"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | No profile picture | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `404` | Passenger not found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint deletes the authenticated passenger's profile picture. The file is permanently removed from the server and the `profilePic` field in the database is set to `null`.

---

### 🔟 Register a New Captain

<div align="center">

**`POST` `/api/captain/register`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-No-red?style=for-the-badge)

</div>

#### 📝 Request Body

| Parameter | Type | Required | Description | Validation |
|-----------|------|----------|-------------|------------|
| `firstname` | String | ✅ Yes | Captain's first name | Min 3 characters |
| `lastname` | String | ✅ Yes | Captain's last name | Min 3 characters |
| `email` | String | ✅ Yes | Captain's email address | Valid email format |
| `password` | String | ✅ Yes | Captain's password | Min 6 characters |
| `vehicle` | Object | ✅ Yes | Vehicle information | See vehicle schema below |
| `location` | Object | ✅ Yes | Captain's location | See location schema below |

#### 🚗 Vehicle Object Schema

| Parameter | Type | Required | Description | Validation |
|-----------|------|----------|-------------|------------|
| `type` | String | ✅ Yes | Vehicle type | 'car', 'bike', or 'rickshaw' |
| `make` | String | ✅ Yes | Vehicle manufacturer | Non-empty string |
| `model` | String | ✅ Yes | Vehicle model | Non-empty string |
| `year` | Number | ❌ No | Manufacturing year | Between 1990 and current year |
| `color` | String | ❌ No | Vehicle color | Any string |
| `numberPlate` | String | ✅ Yes | License plate number | Format: LEB-1234 |
| `capacity` | Number | ✅ Yes | Passenger capacity | Minimum 1 |

#### 📍 Location Object Schema

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `latitude` | Number | ✅ Yes | Latitude coordinate |
| `longitude` | Number | ✅ Yes | Longitude coordinate |

#### 📤 Example Request

```json
{
  "firstname": "Ahmed",
  "lastname": "Khan",
  "email": "ahmed.khan@example.com",
  "password": "password123",
  "vehicle": {
    "type": "car",
    "make": "Toyota",
    "model": "Corolla",
    "year": 2020,
    "color": "White",
    "numberPlate": "LEB-1234",
    "capacity": 4
  },
  "location": {
    "latitude": 33.7490,
    "longitude": -84.3880
  }
}
```

#### ✅ Success Response

```
Code: 201 Created
```

```json
{
  "message": "Captain registered successfully",
  "captain": {
    "_id": "64f8a1b2c3d4e5f6a7b8c9d0",
    "firstname": "Ahmed",
    "lastname": "Khan",
    "email": "ahmed.khan@example.com",
    "status": "active",
    "vehicle": {
      "type": "car",
      "make": "Toyota",
      "model": "Corolla",
      "year": 2020,
      "color": "White",
      "numberPlate": "LEB-1234",
      "capacity": 4
    },
    "location": {
      "latitude": 33.7490,
      "longitude": -84.3880
    },
    "createdAt": "2024-01-15T10:30:00.000Z",
    "updatedAt": "2024-01-15T10:30:00.000Z"
  },
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | Validation failed | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Vehicle type invalid | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Number plate format invalid | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Number plate already exists | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `409` | Email already exists (Captain) | ![Conflict](https://img.shields.io/badge/409-Conflict-orange) |
| `409` | Email already exists (Passenger) | ![Conflict](https://img.shields.io/badge/409-Conflict-orange) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** Upon successful registration, a JWT token is generated and returned in the response. The vehicle number plate must be unique across all captains.

---

### 1️⃣1️⃣ Captain Login

<div align="center">

**`POST` `/api/captain/login`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-No-red?style=for-the-badge)

</div>

#### 📝 Request Body

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `email` | String | ✅ Yes | Captain's email address |
| `password` | String | ✅ Yes | Captain's password |

#### 📤 Example Request

```json
{
  "email": "ahmed.khan@example.com",
  "password": "password123"
}
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Captain logged in successfully",
  "captain": {
    "_id": "64f8a1b2c3d4e5f6a7b8c9d0",
    "firstname": "Ahmed",
    "lastname": "Khan",
    "email": "ahmed.khan@example.com",
    "status": "active",
    "vehicle": {
      "type": "car",
      "make": "Toyota",
      "model": "Corolla",
      "year": 2020,
      "color": "White",
      "numberPlate": "LEB-1234",
      "capacity": 4
    },
    "location": {
      "latitude": 33.7490,
      "longitude": -84.3880
    },
    "createdAt": "2024-01-15T10:30:00.000Z",
    "updatedAt": "2024-01-15T10:30:00.000Z"
  },
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | Missing fields | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Invalid email format | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `401` | Invalid credentials | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `401` | Email belongs to passenger | ![Unauthorized](https://img.shields.io/badge/401-Cross--Model-orange) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** Upon successful login, a JWT token is set in an HTTP-only cookie and returned in the response.

---

### 1️⃣2️⃣ Get Captain Profile

<div align="center">

**`GET` `/api/captain/profile`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Captain profile retrieved successfully",
  "captain": {
    "_id": "64f8a1b2c3d4e5f6a7b8c9d0",
    "firstname": "Ahmed",
    "lastname": "Khan",
    "email": "ahmed.khan@example.com",
    "status": "active",
    "vehicle": {
      "type": "car",
      "make": "Toyota",
      "model": "Corolla",
      "year": 2020,
      "color": "White",
      "numberPlate": "LEB-1234",
      "capacity": 4
    },
    "location": {
      "latitude": 33.7490,
      "longitude": -84.3880
    },
    "socketId": null,
    "createdAt": "2024-01-15T10:30:00.000Z",
    "updatedAt": "2024-01-15T10:30:00.000Z"
  }
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `401` | Invalid token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint returns the authenticated captain's profile data excluding sensitive information like password.

---

### 1️⃣3️⃣ Captain Logout

<div align="center">

**`POST` `/api/captain/logout`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Captain logged out successfully",
  "captain": {
    "_id": "64f8a1b2c3d4e5f6a7b8c9d0",
    "firstname": "Ahmed",
    "lastname": "Khan",
    "email": "ahmed.khan@example.com",
    "status": "active",
    "vehicle": {
      "type": "car",
      "make": "Toyota",
      "model": "Corolla",
      "year": 2020,
      "color": "White",
      "numberPlate": "LEB-1234",
      "capacity": 4
    },
    "location": {
      "latitude": 33.7490,
      "longitude": -84.3880
    },
    "socketId": null,
    "createdAt": "2024-01-15T10:30:00.000Z",
    "updatedAt": "2024-01-15T10:30:00.000Z"
  }
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `401` | Invalid token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `404` | Captain not found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint clears the authentication cookie and clears the captain's socketId for real-time features.

---

### 1️⃣4️⃣ Send Verification OTP

<div align="center">

**`POST` `/api/captain/send-verification-otp`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Verification OTP sent successfully"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | Account already verified | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `404` | User not found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint sends a 6-digit OTP to the captain's email for account verification. The OTP expires in 10 minutes.

---

### 1️⃣5️⃣ Verify Captain Account with OTP

<div align="center">

**`POST` `/api/captain/verify-otp`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
```

#### 📝 Request Body

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `otp` | String | ✅ Yes | 6-digit verification OTP |

#### 📤 Example Request

```json
{
  "otp": "123456"
}
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Account verified successfully"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | OTP required | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Invalid OTP | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | OTP expired | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `404` | User not found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint verifies the captain's account using the OTP sent to their email. Once verified, the account status is updated.

---

### 1️⃣6️⃣ Check Captain Authentication Status

<div align="center">

**`POST` `/api/captain/is-authenticated`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "User is authenticated"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `401` | Invalid token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint checks if the captain is currently authenticated with a valid JWT token.

---

### 1️⃣7️⃣ Send Captain Password Reset OTP

<div align="center">

**`POST` `/api/captain/send-reset-password-otp`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-No-red?style=for-the-badge)

</div>

#### 📝 Request Body

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `email` | String | ✅ Yes | Captain's email address |

#### 📤 Example Request

```json
{
  "email": "ahmed.khan@example.com"
}
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Password reset OTP sent successfully"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | Email required | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Account not verified | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `404` | No account found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint sends a 6-digit OTP to the captain's email for password reset. The account must be verified first.

---

### 1️⃣8️⃣ Reset Captain Password with OTP

<div align="center">

**`POST` `/api/captain/reset-password`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-No-red?style=for-the-badge)

</div>

#### 📝 Request Body

| Parameter | Type | Required | Description | Validation |
|-----------|------|----------|-------------|------------|
| `email` | String | ✅ Yes | Captain's email address | Valid email format |
| `otp` | String | ✅ Yes | 6-digit reset OTP | 6 characters |
| `newPassword` | String | ✅ Yes | New password | Min 6 characters |

#### 📤 Example Request

```json
{
  "email": "ahmed.khan@example.com",
  "otp": "123456",
  "newPassword": "newpassword123"
}
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Password reset successful"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | Missing fields | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Password too short | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Invalid OTP | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | OTP expired | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Same password | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `404` | No account found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint resets the captain's password using the OTP sent to their email. The new password must be different from the current one.

---

### 2️⃣2️⃣ Upload Captain Profile Picture

<div align="center">

**`POST` `/api/captain/upload-profile-pic`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
Content-Type: multipart/form-data
```

#### 📝 Request Body (Form Data)

| Parameter | Type | Required | Description | Validation |
|-----------|------|----------|-------------|------------|
| `profilePic` | File | ✅ Yes | Image file for profile picture | JPG/JPEG/PNG, max 2MB |

#### 📤 Example Request

```javascript
const formData = new FormData();
formData.append('profilePic', selectedFile);

fetch('/api/captain/upload-profile-pic', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'
  },
  body: formData
});
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Profile picture uploaded successfully",
  "profilePic": "/uploads/profile-pictures/64f8a1b2c3d4e5f6a7b8c9d0_1673788800000.jpg"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | No file uploaded | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Invalid file type | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | File too large | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `404` | Captain not found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint uploads a new profile picture for the authenticated captain. If a profile picture already exists, it will be replaced and the old file will be deleted. Maximum file size is 2MB. Accepted formats: JPG, JPEG, PNG.

---

### 2️⃣3️⃣ Update Captain Profile Picture

<div align="center">

**`PUT` `/api/captain/update-profile-pic`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
Content-Type: multipart/form-data
```

#### 📝 Request Body (Form Data)

| Parameter | Type | Required | Description | Validation |
|-----------|------|----------|-------------|------------|
| `profilePic` | File | ✅ Yes | New image file for profile picture | JPG/JPEG/PNG, max 2MB |

#### 📤 Example Request

```javascript
const formData = new FormData();
formData.append('profilePic', selectedFile);

fetch('/api/captain/update-profile-pic', {
  method: 'PUT',
  headers: {
    'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'
  },
  body: formData
});
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Profile picture updated successfully",
  "profilePic": "/uploads/profile-pictures/64f8a1b2c3d4e5f6a7b8c9d0_1673788900000.jpg"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | No file uploaded | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | Invalid file type | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `400` | File too large | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `404` | Captain not found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint updates an existing profile picture for the authenticated captain. The old profile picture file will be automatically deleted from the server. If no profile picture exists, this works the same as upload.

---

### 2️⃣4️⃣ Delete Captain Profile Picture

<div align="center">

**`DELETE` `/api/captain/delete-profile-pic`**

![Auth Required](https://img.shields.io/badge/Auth%20Required-Yes-green?style=for-the-badge)

</div>

#### 🔑 Headers

```
Authorization: Bearer <jwt-token>
```

#### ✅ Success Response

```
Code: 200 OK
```

```json
{
  "success": true,
  "message": "Profile picture deleted successfully"
}
```

#### ❌ Error Responses

<div align="center">

| Status | Error Type | Response |
|--------|------------|----------|
| `400` | No profile picture | ![Bad Request](https://img.shields.io/badge/400-Bad%20Request-red) |
| `401` | No token | ![Unauthorized](https://img.shields.io/badge/401-Unauthorized-orange) |
| `404` | Captain not found | ![Not Found](https://img.shields.io/badge/404-Not%20Found-red) |
| `500` | Internal server error | ![Server Error](https://img.shields.io/badge/500-Server%20Error-red) |

</div>

**💡 Note:** This endpoint deletes the authenticated captain's profile picture. The file is permanently removed from the server and the `profilePic` field in the database is set to `null`.

---

## 🚖 Captain-Specific Features

<div align="center">

### 📧 **Captain Email System**

| Feature | Description | Status |
|---------|-------------|--------|
| 🎉 **Welcome Email** | Personalized welcome message for new captains | ✅ Ready |
| ✅ **Verification OTP** | Account verification via email OTP | ✅ Ready |
| 🔒 **Password Reset** | Secure password reset via email OTP | ✅ Ready |
| 🚗 **Vehicle Validation** | Comprehensive vehicle information validation | ✅ Ready |
| 📍 **Location Tracking** | Real-time location coordinates support | ✅ Ready |

</div>

### 🌟 **Enhanced Email Template System**

#### 📧 **Passenger Email Templates**
- **🎨 Premium Design**: Glassmorphism effects with ambient gradient orbs
- **📱 Mobile-First**: Responsive HTML with table-based layouts
- **🔐 Security-Focused**: Enhanced password reset with security notices
- **🎯 Professional Branding**: Google Fonts (Inter, Poppins) and brand colors
- **✨ Modern Aesthetics**: Dark theme with high-contrast CTAs

#### 🚗 **Captain Email Templates**  
- **🚖 Driver-Focused Messaging**: All emails tailored for driver partners
- **💼 Professional Tone**: Business-oriented communication style
- **🔐 Secure Verification**: OTP-based account verification system
- **📱 Mobile-Optimized**: Responsive email templates for all devices
- **🎨 Consistent Branding**: Sawari.pk design system throughout
- **🚗 Vehicle Integration**: Welcome emails include vehicle information

#### 🎯 **Template Features**
- **🌈 Brand Gradients**: Four-color gradient system matching UI
- **🔒 Security Elements**: Enhanced security notices and warnings
- **📊 Professional Layout**: Clean, structured email composition
- **⚡ Fast Loading**: Optimized images and efficient CSS
- **🎨 Visual Hierarchy**: Clear typography and spacing system

### 🔄 **Cross-Model Email Validation System**

#### 🎯 **Email Uniqueness Enforcement**
- **📵 Global Email Validation**: Prevents same email from being used for both passenger and captain accounts
- **👥 Account Type Detection**: Smart error messages guide users to correct login/registration
- **🔐 Registration Protection**: Cross-model validation during account creation
- **🔑 Login Intelligence**: Helpful guidance when users attempt wrong account type login
- **🔄 Password Reset Safety**: Cross-model validation for password reset requests

#### 🚀 **Implementation Features**
<div align="center">

| Validation Point | Passenger → Captain | Captain → Passenger | Status |
|------------------|----------------------|---------------------|--------|
| **Registration** | Checks captain model | Checks passenger model | ✅ Active |
| **Login Attempt** | Guides to captain login | Guides to passenger login | ✅ Active |
| **Password Reset** | Directs to captain reset | Directs to passenger reset | ✅ Active |
| **Error Messages** | Specific, helpful guidance | Specific, helpful guidance | ✅ Active |

</div>

#### 💬 **Smart Error Messages**
- **Registration**: "This email is already been used. Please use a different email address."
- **Login**: "This email is registered as a [account-type] account. Please use the [correct-type] login..."
- **Password Reset**: "This email is registered as a [account-type] account. Please use the [correct-type] password reset..."

#### 🔒 **Security Benefits**
- **📊 Data Integrity**: Ensures email uniqueness across the entire system
- **🛡️ Account Protection**: Prevents accidental account conflicts
- **🎯 Clear Separation**: Maintains distinct passenger and captain identities
- **📝 User Experience**: Clear, helpful error messages prevent confusion

---

## 🗄️ Database Schema

### 📊 Passenger Model

```javascript
{
  firstname: {
    type: String,
    required: true,
    minlength: 3
  },
  lastname: {
    type: String,
    required: true,
    minlength: 3
  },
  email: {
    type: String,
    required: true,
    unique: true,
    lowercase: true,
    validate: email format
  },
  profilePic: {
    type: String,
    default: null,
    validate: JPG/JPEG/PNG format  // 🖼️ Profile picture path
  },
  password: {
    type: String,
    required: true,
    select: false  // 🔒 Hidden from queries by default
  },
  socketId: {
    type: String  // 📡 For real-time features
  },
  // Account verification fields
  isAccountVerified: {
    type: Boolean,
    default: false
  },
  verifyOtp: {
    type: String,
    default: ''
  },
  verifyOtpExpiry: {
    type: Number,
    default: 0
  },
  // Password reset fields
  forgotPasswordOtp: {
    type: String,
    default: ''
  },
  forgotPasswordOtpExpiry: {
    type: Number,
    default: 0
  }
}
```

### 🚗 Captain Model

```javascript
{
  firstname: {
    type: String,
    required: true,
    minlength: 3
  },
  lastname: {
    type: String,
    required: true,
    minlength: 3
  },
  email: {
    type: String,
    required: true,
    unique: true,
    lowercase: true,
    validate: email format
  },
  profilePic: {
    type: String,
    default: null,
    validate: JPG/JPEG/PNG format  // 🖼️ Profile picture path
  },
  password: {
    type: String,
    required: true,
    select: false  // 🔒 Hidden from queries by default
  },
  socketId: {
    type: String  // 📡 For real-time features
  },
  status: {
    type: String,
    enum: ['active', 'inactive'],
    default: 'active'
  },
  vehicle: {
    type: {
      type: String,
      enum: ['car', 'bike', 'rickshaw'],
      required: true
    },
    make: { type: String, required: true },
    model: { type: String, required: true },
    year: { type: Number, min: 1990, max: current year },
    color: { type: String },
    numberPlate: { 
      type: String, 
      required: true, 
      unique: true, 
      uppercase: true,
      match: /^[A-Z]{2,3}-\d{1,4}$/  // Format: LEB-1234
    },
    capacity: { type: Number, required: true, min: 1 }
  },
  location: {
    latitude: { type: Number, required: true },
    longitude: { type: Number, required: true }
  },
  // Account verification fields
  isAccountVerified: {
    type: Boolean,
    default: false
  },
  verifyOtp: {
    type: String,
    default: ''
  },
  verifyOtpExpiry: {
    type: Number,
    default: 0
  },
  // Password reset fields
  forgotPasswordOtp: {
    type: String,
    default: ''
  },
  forgotPasswordOtpExpiry: {
    type: Number,
    default: 0
  }
}
```

---

## 🔧 Project Structure

<div align="center">

### 📁 Backend Architecture

```
sawaridotpk-v2/
├── 📁 backend/
│   ├── 📁 config/
│   │   └── 🔗 connectDB.js              # MongoDB connection
│   ├── 📁 controllers/
│   │   ├── 🎮 passenger.controller.js   # Passenger API logic
│   │   └── 🎮 captain.controller.js     # Captain API logic
│   ├── 📁 middleware/
│   │   └── 🛡️ auth.middleware.js        # JWT authentication
│   ├── 📁 models/
│   │   ├── 📊 passenger.model.js        # Passenger schema
│   │   └── 📊 captain.model.js          # Captain schema
│   ├── 📁 routes/
│   │   ├── 🛣️ passenger.route.js        # Passenger endpoints
│   │   └── 🛣️ captain.route.js          # Captain endpoints
│   ├── 📁 services/
│   │   └── 📧 email.service.js          # Email service
│   ├── 🚀 app.js                        # Express server
│   ├── 📦 package.json                  # Dependencies
│   └── 📦 package-lock.json             # Lock file
├── 📄 readme.md                         # Documentation
└── 📄 .gitignore                        # Git ignore
```

</div>

### 🏗️ Architecture Overview

<div align="center">

| **Layer** | **Directory** | **Purpose** | **Files** |
|-----------|---------------|-------------|-----------|
| **🛣️ Routes** | `routes/` | API endpoint definitions | `passenger.route.js`, `captain.route.js` |
| **🎮 Controllers** | `controllers/` | Business logic & request handling | `passenger.controller.js`, `captain.controller.js` |
| **📊 Models** | `models/` | Database schemas & validation | `passenger.model.js`, `captain.model.js` |
| **🛡️ Middleware** | `middleware/` | Authentication & validation | `auth.middleware.js` |
| **⚙️ Config** | `config/` | Database & environment setup | `connectDB.js` |

</div>

### 📋 File Status

<div align="center">

| **File** | **Type** | **Status** | **Description** |
|----------|----------|------------|-----------------|
| `app.js` | Server | ✅ Ready | Express app configuration |
| `connectDB.js` | Database | ✅ Ready | MongoDB connection setup |
| `auth.middleware.js` | Security | ✅ Ready | JWT authentication |
| `upload.middleware.js` | Upload | ✅ Ready | File upload handling with Multer |
| `passenger.controller.js` | API | ✅ Ready | Passenger CRUD operations + Profile Pictures |
| `captain.controller.js` | API | ✅ Ready | Captain CRUD operations + Profile Pictures |
| `passenger.model.js` | Schema | ✅ Ready | Passenger data model with profilePic field |
| `captain.model.js` | Schema | ✅ Ready | Captain data model with profilePic field |
| `passenger.route.js` | Routes | ✅ Ready | Passenger API endpoints + Profile Picture routes |
| `captain.route.js` | Routes | ✅ Ready | Captain API endpoints + Profile Picture routes |
| `email.service.js` | Service | ✅ Ready | Email sending functionality |
| `uploads/profile-pictures/` | Storage | ✅ Auto-created | Profile picture file storage directory |

</div>

</div>

---

## 🛡️ Security Features

<div align="center">

| Feature | Description | Status |
|---------|-------------|--------|
| 🔐 **Password Hashing** | bcrypt with salt rounds | ✅ Implemented |
| 🔑 **JWT Authentication** | Secure token-based auth | ✅ Implemented |
| 🍪 **HTTP-only Cookies** | XSS protection | ✅ Implemented |
| 🌐 **CORS Configuration** | Cross-origin security | ✅ Implemented |
| ✅ **Input Validation** | Comprehensive field validation | ✅ Implemented |
| 🔐 **OTP Authentication** | Email-based OTP verification | ✅ Implemented |
| 📧 **Email Service** | Nodemailer integration | ✅ Implemented |
| 🚗 **Captain Email Features** | Captain-specific welcome, verification & reset emails | ✅ Implemented |
| 🔄 **Cross-Model Email Validation** | Email uniqueness across passenger & captain models | ✅ Implemented |
| 🖼️ **Profile Picture Security** | File type validation, size limits, secure storage | ✅ Implemented |
| 🛡️ **Error Handling** | Secure error responses | ✅ Implemented |

</div>

### 🌟 **Enhanced Email Template System**

#### 📧 **Passenger Email Templates**
- **🎨 Premium Design**: Glassmorphism effects with ambient gradient orbs
- **📱 Mobile-First**: Responsive HTML with table-based layouts
- **🔐 Security-Focused**: Enhanced password reset with security notices
- **🎯 Professional Branding**: Google Fonts (Inter, Poppins) and brand colors
- **✨ Modern Aesthetics**: Dark theme with high-contrast CTAs

#### 🚗 **Captain Email Templates**  
- **🚖 Driver-Focused Messaging**: All emails tailored for driver partners
- **💼 Professional Tone**: Business-oriented communication style
- **🔐 Secure Verification**: OTP-based account verification system
- **📱 Mobile-Optimized**: Responsive email templates for all devices
- **🎨 Consistent Branding**: Sawari.pk design system throughout
- **🚗 Vehicle Integration**: Welcome emails include vehicle information

#### 🎯 **Template Features**
- **🌈 Brand Gradients**: Four-color gradient system matching UI
- **🔒 Security Elements**: Enhanced security notices and warnings
- **📊 Professional Layout**: Clean, structured email composition
- **⚡ Fast Loading**: Optimized images and efficient CSS
- **🎨 Visual Hierarchy**: Clear typography and spacing system

### 🔄 **Cross-Model Email Validation System**

#### 🎯 **Email Uniqueness Enforcement**
- **📵 Global Email Validation**: Prevents same email from being used for both passenger and captain accounts
- **👥 Account Type Detection**: Smart error messages guide users to correct login/registration
- **🔐 Registration Protection**: Cross-model validation during account creation
- **🔑 Login Intelligence**: Helpful guidance when users attempt wrong account type login
- **🔄 Password Reset Safety**: Cross-model validation for password reset requests

#### 🚀 **Implementation Features**
<div align="center">

| Validation Point | Passenger → Captain | Captain → Passenger | Status |
|------------------|----------------------|---------------------|--------|
| **Registration** | Checks captain model | Checks passenger model | ✅ Active |
| **Login Attempt** | Guides to captain login | Guides to passenger login | ✅ Active |
| **Password Reset** | Directs to captain reset | Directs to passenger reset | ✅ Active |
| **Error Messages** | Specific, helpful guidance | Specific, helpful guidance | ✅ Active |

</div>

#### 💬 **Smart Error Messages**
- **Registration**: "This email is already been used. Please use a different email address."
- **Login**: "This email is registered as a [account-type] account. Please use the [correct-type] login..."
- **Password Reset**: "This email is registered as a [account-type] account. Please use the [correct-type] password reset..."

#### 🔒 **Security Benefits**
- **📊 Data Integrity**: Ensures email uniqueness across the entire system
- **🛡️ Account Protection**: Prevents accidental account conflicts
- **🎯 Clear Separation**: Maintains distinct passenger and captain identities
- **📝 User Experience**: Clear, helpful error messages prevent confusion

---

## 🗄️ Database Schema

### 📊 Passenger Model

```javascript
{
  firstname: {
    type: String,
    required: true,
    minlength: 3
  },
  lastname: {
    type: String,
    required: true,
    minlength: 3
  },
  email: {
    type: String,
    required: true,
    unique: true,
    lowercase: true,
    validate: email format
  },
  profilePic: {
    type: String,
    default: null,
    validate: JPG/JPEG/PNG format  // 🖼️ Profile picture path
  },
  password: {
    type: String,
    required: true,
    select: false  // 🔒 Hidden from queries by default
  },
  socketId: {
    type: String  // 📡 For real-time features
  },
  // Account verification fields
  isAccountVerified: {
    type: Boolean,
    default: false
  },
  verifyOtp: {
    type: String,
    default: ''
  },
  verifyOtpExpiry: {
    type: Number,
    default: 0
  },
  // Password reset fields
  forgotPasswordOtp: {
    type: String,
    default: ''
  },
  forgotPasswordOtpExpiry: {
    type: Number,
    default: 0
  }
}
```

### 🚗 Captain Model

```javascript
{
  firstname: {
    type: String,
    required: true,
    minlength: 3
  },
  lastname: {
    type: String,
    required: true,
    minlength: 3
  },
  email: {
    type: String,
    required: true,
    unique: true,
    lowercase: true,
    validate: email format
  },
  profilePic: {
    type: String,
    default: null,
    validate: JPG/JPEG/PNG format  // 🖼️ Profile picture path
  },
  password: {
    type: String,
    required: true,
    select: false  // 🔒 Hidden from queries by default
  },
  socketId: {
    type: String  // 📡 For real-time features
  },
  status: {
    type: String,
    enum: ['active', 'inactive'],
    default: 'active'
  },
  vehicle: {
    type: {
      type: String,
      enum: ['car', 'bike', 'rickshaw'],
      required: true
    },
    make: { type: String, required: true },
    model: { type: String, required: true },
    year: { type: Number, min: 1990, max: current year },
    color: { type: String },
    numberPlate: { 
      type: String, 
      required: true, 
      unique: true, 
      uppercase: true,
      match: /^[A-Z]{2,3}-\d{1,4}$/  // Format: LEB-1234
    },
    capacity: { type: Number, required: true, min: 1 }
  },
  location: {
    latitude: { type: Number, required: true },
    longitude: { type: Number, required: true }
  },
  // Account verification fields
  isAccountVerified: {
    type: Boolean,
    default: false
  },
  verifyOtp: {
    type: String,
    default: ''
  },
  verifyOtpExpiry: {
    type: Number,
    default: 0
  },
  // Password reset fields
  forgotPasswordOtp: {
    type: String,
    default: ''
  },
  forgotPasswordOtpExpiry: {
    type: Number,
    default: 0
  }
}
```

---

## 🔧 Project Structure

<div align="center">

### 📁 Backend Architecture

```
sawaridotpk-v2/
├── 📁 backend/
│   ├── 📁 config/
│   │   └── 🔗 connectDB.js              # MongoDB connection
│   ├── 📁 controllers/
│   │   ├── 🎮 passenger.controller.js   # Passenger API logic
│   │   └── 🎮 captain.controller.js     # Captain API logic
│   ├── 📁 middleware/
│   │   └── 🛡️ auth.middleware.js        # JWT authentication
│   ├── 📁 models/
│   │   ├── 📊 passenger.model.js        # Passenger schema
│   │   └── 📊 captain.model.js          # Captain schema
│   ├── 📁 routes/
│   │   ├── 🛣️ passenger.route.js        # Passenger endpoints
│   │   └── 🛣️ captain.route.js          # Captain endpoints
│   ├── 📁 services/
│   │   └── 📧 email.service.js          # Email service
│   ├── 🚀 app.js                        # Express server
│   ├── 📦 package.json                  # Dependencies
│   └── 📦 package-lock.json             # Lock file
├── 📄 readme.md                         # Documentation
└── 📄 .gitignore                        # Git ignore
```

</div>

### 🏗️ Architecture Overview

<div align="center">

| **Layer** | **Directory** | **Purpose** | **Files** |
|-----------|---------------|-------------|-----------|
| **🛣️ Routes** | `routes/` | API endpoint definitions | `passenger.route.js`, `captain.route.js` |
| **🎮 Controllers** | `controllers/` | Business logic & request handling | `passenger.controller.js`, `captain.controller.js` |
| **📊 Models** | `models/` | Database schemas & validation | `passenger.model.js`, `captain.model.js` |
| **🛡️ Middleware** | `middleware/` | Authentication & validation | `auth.middleware.js` |
| **⚙️ Config** | `config/` | Database & environment setup | `connectDB.js` |

</div>

### 📋 File Status

<div align="center">

| **File** | **Type** | **Status** | **Description** |
|----------|----------|------------|-----------------|
| `app.js` | Server | ✅ Ready | Express app configuration |
| `connectDB.js` | Database | ✅ Ready | MongoDB connection setup |
| `auth.middleware.js` | Security | ✅ Ready | JWT authentication |
| `passenger.controller.js` | API | ✅ Ready | Passenger CRUD operations |
| `captain.controller.js` | API | ✅ Ready | Captain CRUD operations |
| `passenger.model.js` | Schema | ✅ Ready | Passenger data model |
| `captain.model.js` | Schema | ✅ Ready | Captain data model |
| `passenger.route.js` | Routes | ✅ Ready | Passenger API endpoints |
| `captain.route.js` | Routes | ✅ Ready | Captain API endpoints |
| `email.service.js` | Service | ✅ Ready | Email sending functionality |

</div>

</div>

---

## 🛡️ Security Features

<div align="center">

| Feature | Description | Status |
|---------|-------------|--------|
| 🔐 **Password Hashing** | bcrypt with salt rounds | ✅ Implemented |
| 🔑 **JWT Authentication** | Secure token-based auth | ✅ Implemented |
| 🍪 **HTTP-only Cookies** | XSS protection | ✅ Implemented |
| 🌐 **CORS Configuration** | Cross-origin security | ✅ Implemented |
| ✅ **Input Validation** | Comprehensive field validation | ✅ Implemented |
| 🔐 **OTP Authentication** | Email-based OTP verification | ✅ Implemented |
| 📧 **Email Service** | Nodemailer integration | ✅ Implemented |
| 🚖 **Captain Email Features** | Captain-specific welcome, verification & reset emails | ✅ Implemented |
| 🔄 **Cross-Model Email Validation** | Email uniqueness across passenger & captain models | ✅ Implemented |
| 🛡️ **Error Handling** | Secure error responses | ✅ Implemented |

</div>

### 🌟 **Enhanced Email Template System**

#### 📧 **Passenger Email Templates**
- **🎨 Premium Design**: Glassmorphism effects with ambient gradient orbs
- **📱 Mobile-First**: Responsive HTML with table-based layouts
- **🔐 Security-Focused**: Enhanced password reset with security notices
- **🎯 Professional Branding**: Google Fonts (Inter, Poppins) and brand colors
- **✨ Modern Aesthetics**: Dark theme with high-contrast CTAs

#### 🚗 **Captain Email Templates**  
- **🚖 Driver-Focused Messaging**: All emails tailored for driver partners
- **💼 Professional Tone**: Business-oriented communication style
- **🔐 Secure Verification**: OTP-based account verification system
- **📱 Mobile-Optimized**: Responsive email templates for all devices
- **🎨 Consistent Branding**: Sawari.pk design system throughout
- **🚗 Vehicle Integration**: Welcome emails include vehicle information

#### 🎯 **Template Features**
- **🌈 Brand Gradients**: Four-color gradient system matching UI
- **🔒 Security Elements**: Enhanced security notices and warnings
- **📊 Professional Layout**: Clean, structured email composition
- **⚡ Fast Loading**: Optimized images and efficient CSS
- **🎨 Visual Hierarchy**: Clear typography and spacing system

---

## 🚀 Production Deployment Guide

<div align="center">

![Production Ready](https://img.shields.io/badge/Production-Ready-brightgreen?style=for-the-badge)
![Version](https://img.shields.io/badge/Version-2.0-blue?style=for-the-badge)
![Status](https://img.shields.io/badge/Status-Deployable-success?style=for-the-badge)

**Your Sawari.pk application is production-ready!** 🎉

</div>

### ✅ Production Readiness Assessment

<div align="center">

| Component | Status | Description |
|-----------|--------|-------------|
| **🔧 Backend API** | ✅ Production Ready | Express.js with comprehensive error handling |
| **⚛️ Frontend SPA** | ✅ Production Ready | React + Vite with optimized build process |
| **🗄️ Database** | ✅ Production Ready | MongoDB with Mongoose ODM |
| **🔐 Authentication** | ✅ Production Ready | JWT + bcrypt security implementation |
| **📧 Email Service** | ✅ Production Ready | Nodemailer with OTP system |
| **🛡️ Security** | ✅ Production Ready | CORS, input validation, error handling |
| **📦 Build System** | ✅ Production Ready | Vite build optimization |
| **🌐 CORS Config** | ✅ Production Ready | Flexible origin management |

</div>

---

## 🌍 Environment Configuration

### 🖥️ Backend Environment Variables

**📁 `backend/.env` (Production)**

```env
# Server Configuration
PORT=3000
NODE_ENV=production

# Database Configuration
MONGOOSE_URL=mongodb+srv://username:password@cluster.mongodb.net/sawari_pk?retryWrites=true&w=majority

# Security Configuration
JWT_SECRET=your-super-secure-256-bit-production-secret-key-here

# CORS Configuration
CORS_ORIGIN=https://yourdomain.com

# Email Service Configuration
EMAIL_USER=noreply@yourdomain.com
EMAIL_PASS=your-app-specific-password
```

### ⚛️ Frontend Environment Variables

**📁 `frontend/.env.production`**

```env
# API Configuration
VITE_API_BASE_URL=https://api.yourdomain.com
```

---

## 🚀 Deployment Options

### 🌟 Recommended: Vercel + Railway/Render

<div align="center">

| Service | Purpose | Cost | Performance |
|---------|---------|------|-------------|
| **Vercel** | Frontend hosting | Free tier | ⚡ Excellent |
| **Railway** | Backend + DB | $5/month | 🚀 Great |
| **Render** | Alternative backend | Free tier | 🔶 Good |

</div>

#### 🎯 Option 1: Vercel + Railway (Recommended)

**📱 Frontend (Vercel)**
```bash
# 1. Connect your GitHub repo to Vercel
# 2. Set build settings:
Build Command: npm run build
Output Directory: dist
Root Directory: frontend

# 3. Add environment variables in Vercel dashboard:
VITE_API_BASE_URL=https://your-backend.railway.app
```

**🔧 Backend (Railway)**
```bash
# 1. Connect your GitHub repo to Railway
# 2. Set root directory: backend
# 3. Add environment variables in Railway dashboard
# 4. Railway auto-detects Node.js and installs dependencies
```

#### 🎯 Option 2: Netlify + Heroku

**📱 Frontend (Netlify)**
```bash
# Build settings:
Build command: npm run build
Publish directory: dist
Base directory: frontend
```

**🔧 Backend (Heroku)**
```bash
# Deploy to Heroku
heroku create your-app-name
git subtree push --prefix backend heroku main
```

---

## 📋 Step-by-Step Deployment

### 🔧 Backend Deployment

#### 1️⃣ **Prepare Backend for Production**

```bash
# Navigate to backend directory
cd backend

# Update package.json for production
npm install --production

# Test production build
NODE_ENV=production npm start
```

#### 2️⃣ **Database Setup (MongoDB Atlas)**

```bash
# 1. Create MongoDB Atlas account
# 2. Create a new cluster
# 3. Create database user
# 4. Get connection string
# 5. Update MONGOOSE_URL in environment variables
```

#### 3️⃣ **Deploy Backend (Railway Example)**

```bash
# 1. Connect GitHub repository to Railway
# 2. Select backend directory as root
# 3. Add environment variables:
```

<div align="center">

| Variable | Value | Required |
|----------|-------|----------|
| `PORT` | `3000` | ✅ Yes |
| `NODE_ENV` | `production` | ✅ Yes |
| `MONGOOSE_URL` | `mongodb+srv://...` | ✅ Yes |
| `JWT_SECRET` | `secure-secret-key` | ✅ Yes |
| `CORS_ORIGIN` | `https://yourdomain.com` | ✅ Yes |
| `EMAIL_USER` | `noreply@yourdomain.com` | ✅ Yes |
| `EMAIL_PASS` | `app-password` | ✅ Yes |

</div>

### ⚛️ Frontend Deployment

#### 1️⃣ **Prepare Frontend for Production**

```bash
# Navigate to frontend directory
cd frontend

# Install dependencies
npm install

# Create production environment file
echo "VITE_API_BASE_URL=https://your-backend.railway.app" > .env.production

# Build for production
npm run build

# Test production build locally
npm run preview
```

#### 2️⃣ **Deploy Frontend (Vercel Example)**

```bash
# Using Vercel CLI
npm install -g vercel
vercel --prod

# Or connect GitHub repo to Vercel dashboard
```

---

## 🛡️ Production Security Checklist

<div align="center">

| Security Measure | Status | Implementation |
|------------------|--------|----------------|
| **🔐 JWT Secret** | ✅ Ready | Generate 256-bit secret for production |
| **🔒 HTTPS Only** | ⚠️ Setup Required | Configure SSL certificates |
| **🍪 Secure Cookies** | ✅ Ready | HTTP-only cookies implemented |
| **🌐 CORS Policy** | ✅ Ready | Whitelist your domain |
| **📝 Input Validation** | ✅ Ready | Express-validator implemented |
| **🔐 Password Hashing** | ✅ Ready | bcrypt with salt rounds |
| **📧 Email Security** | ✅ Ready | App-specific passwords |
| **🛡️ Error Handling** | ✅ Ready | No sensitive data in responses |

</div>

### 🔐 Generate Secure JWT Secret

```bash
# Generate a secure JWT secret (256-bit)
node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
```

---

## 📊 Performance Optimization

### ⚡ Frontend Optimizations

<div align="center">

| Optimization | Status | Benefit |
|--------------|--------|----------|
| **🗜️ Vite Build** | ✅ Active | Code splitting & tree shaking |
| **📦 Bundle Analysis** | ⚠️ Manual | Analyze bundle size |
| **🖼️ Image Optimization** | ⚠️ Manual | Compress images |
| **⚡ Lazy Loading** | ⚠️ Manual | Load components on demand |
| **📱 Progressive Web App** | ⚠️ Manual | PWA features |

</div>

### 🔧 Backend Optimizations

```bash
# Add compression middleware (optional)
npm install compression
```

---

## 🔍 Monitoring & Logging

### 📊 Recommended Tools

<div align="center">

| Tool | Purpose | Price | Integration |
|------|---------|-------|-------------|
| **Sentry** | Error tracking | Free tier | Easy |
| **LogRocket** | Session replay | Free tier | Medium |
| **Uptime Robot** | Uptime monitoring | Free | Easy |
| **Google Analytics** | User analytics | Free | Easy |

</div>

---

## 🚀 Quick Production Deployment

### ⚡ One-Click Deploy Options

[![Deploy with Vercel](https://vercel.com/button)](https://vercel.com/new/clone?repository-url=https://github.com/gauravkhatriweb/sawaridotpk&root-directory=frontend)

[![Deploy on Railway](https://railway.app/button.svg)](https://railway.app/new/template?template=https://github.com/gauravkhatriweb/sawaridotpk&root=backend)

### 🎯 Production Deployment Status

<div align="center">

| Step | Action | Estimated Time | Status |
|------|--------|----------------|--------|
| 1️⃣ | **MongoDB Atlas Setup** | 10 minutes | ⏳ Ready |
| 2️⃣ | **Backend Deployment** | 15 minutes | ⏳ Ready |
| 3️⃣ | **Frontend Deployment** | 10 minutes | ⏳ Ready |
| 4️⃣ | **Domain & SSL Setup** | 30 minutes | ⏳ Ready |
| 5️⃣ | **Testing & Verification** | 20 minutes | ⏳ Ready |
| **🎉 Total Deployment Time** | **~90 minutes** | **✅ Production Ready** |

</div>

**🎉 Your application is fully production-ready and can be deployed immediately!**

---

## 🤝 Contributing

<div align="center">

**We welcome contributions to improve Sawari.pk!** 🎉

![Contributions Welcome](https://img.shields.io/badge/Contributions-Welcome-brightgreen?style=for-the-badge)

</div>

### 🐛 Reporting Bugs

1. 🔍 Check if the bug has already been reported in the [Issues](https://github.com/gauravkhatriweb/sawaridotpk/issues) section
2. 📝 Create a new issue with a clear title and description
3. 📋 Include steps to reproduce the bug
4. 📸 Add screenshots or error logs if applicable

### 💡 Suggesting Features

1. 🔍 Check if the feature has already been suggested
2. 🏷️ Create a new issue with the "enhancement" label
3. 📝 Describe the feature and its benefits
4. 📋 Provide use cases and examples

### 🔧 Code Contributions

<div align="center">

#### 🚀 Quick Start Guide

```bash
# 1️⃣ Fork the repository
git clone https://github.com/your-username/sawaridotpk.git
cd sawaridotpk

# 2️⃣ Create a feature branch
git checkout -b feature/amazing-feature

# 3️⃣ Install dependencies
cd backend
npm install

# 4️⃣ Make your changes and test
# ... your code changes ...

# 5️⃣ Commit your changes
git add .
git commit -m '✨ Add amazing feature'

# 6️⃣ Push to your fork
git push origin feature/amazing-feature

# 7️⃣ Open a Pull Request
# Go to GitHub and create a new Pull Request
```

</div>

#### 📝 Development Workflow

<div align="center">

| **Step** | **Action** | **Description** |
|----------|------------|-----------------|
| **1️⃣ Fork** | Clone repository | Create your own copy of the project |
| **2️⃣ Branch** | Create feature branch | Work on isolated feature/issue |
| **3️⃣ Code** | Implement changes | Write clean, documented code |
| **4️⃣ Test** | Verify functionality | Ensure everything works correctly |
| **5️⃣ Commit** | Save changes | Use descriptive commit messages |
| **6️⃣ Push** | Upload to GitHub | Share your changes |
| **7️⃣ PR** | Create Pull Request | Submit for review |

</div>

### 📝 Code Style Guidelines

- 🎨 Follow the existing code style and formatting
- 💭 Add comments for complex logic
- 📝 Write meaningful commit messages
- 🛡️ Include error handling
- 🧪 Test your changes thoroughly

### 🧪 Testing

- ✅ Test your changes locally before submitting
- ✅ Ensure all existing tests pass
- ✅ Add new tests for new features
- ✅ Test edge cases and error scenarios

### 📋 Pull Request Process

1. 📝 Update the README.md if needed
2. 📚 Update documentation for new features
3. ✅ Ensure the build passes
4. 👥 Request review from maintainers
5. 🔄 Address any feedback or requested changes

### 🎯 Contribution Areas

<div align="center">

| Area | Description | Priority |
|------|-------------|----------|
| 🔧 **Backend API** | New endpoints, improvements, optimizations | 🔥 High |
| 🗄️ **Database** | Schema improvements, queries optimization | 🔥 High |
| 🛡️ **Security** | Security enhancements, vulnerability fixes | 🔥 High |
| 📚 **Documentation** | API docs, code comments, guides | 🔶 Medium |
| 🧪 **Testing** | Unit tests, integration tests | 🔶 Medium |
| ⚡ **Performance** | Performance improvements, caching | 🔶 Medium |

</div>

---

## 📄 License

<div align="center">

This project is licensed under the **MIT License**.

![License](https://img.shields.io/badge/License-MIT-green?style=for-the-badge)

See the [LICENSE](LICENSE) file for details.

</div>

---

## 📞 Support

<div align="center">

**For support, questions, or collaboration:**

[![Website](https://img.shields.io/badge/Website-gauravkhatriweb.bio-blue?style=for-the-badge)](https://gauravkhatriweb.bio)
[![Email](https://img.shields.io/badge/Email-gauravkhatriweb%40gmail.com-red?style=for-the-badge)](mailto:gauravkhatriweb@gmail.com)
[![GitHub](https://img.shields.io/badge/GitHub-%40gauravkhatriweb-black?style=for-the-badge&logo=github)](https://github.com/gauravkhatriweb)
[![Repository](https://img.shields.io/badge/Repository-sawaridotpk-green?style=for-the-badge)](https://github.com/gauravkhatriweb/sawaridotpk.git)

</div>

---

<div align="center">

**Made with ❤️ by [Gaurav Khatri](https://gauravkhatriweb.bio)**

![GitHub stars](https://img.shields.io/github/stars/gauravkhatriweb/sawaridotpk?style=social)
![GitHub forks](https://img.shields.io/github/forks/gauravkhatriweb/sawaridotpk?style=social)

**⭐ Star this repository if you found it helpful!**

</div>
